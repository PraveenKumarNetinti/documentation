---
title: "Project foundation & core setup"
description: "I'll build this production-grade Django application in phases. Let me start with Phase 1, which covers the essential foundation."
sidebarTitle: "Core setup"
---

## Phase 1 Overview

<Info>
Phase 1 establishes the foundation for your entire application. Take time to get this right—it will save countless hours later.
</Info>

**What we'll build:**

1. Project structure setup
2. Base configuration (settings split by environment)
3. Custom User model
4. Core base models and utilities
5. Database configuration with PostgreSQL
6. Basic middleware setup
7. Essential package installation

---

## Project Structure

```
saas_platform/
├── manage.py
├── requirements/
│   ├── base.txt
│   ├── development.txt
│   ├── production.txt
│   └── test.txt
├── config/
│   ├── __init__.py
│   ├── asgi.py
│   ├── wsgi.py
│   ├── urls.py
│   └── settings/
│       ├── __init__.py
│       ├── base.py
│       ├── development.py
│       ├── production.py
│       └── test.py
├── apps/
│   ├── __init__.py
│   ├── core/
│   ├── authentication/
│   ├── organizations/
│   ├── teams/
│   ├── invitations/
│   ├── rbac/
│   ├── billing/
│   ├── products/
│   ├── notifications/
│   └── audit/
├── tests/
│   ├── __init__.py
│   ├── factories/
│   └── integration/
├── static/
├── media/
├── logs/
├── .env.example
├── .gitignore
├── pytest.ini
├── setup.cfg
└── README.md
```

---

## Requirements Files

### `requirements/base.txt`

Core dependencies needed for all environments (development, production, testing).

```txt
# Core Django
Django==4.2.9  # Main web framework
django-environ==0.11.2  # Manage environment variables

# Database
psycopg2-binary==2.9.9  # PostgreSQL adapter
django-postgres-extra==2.0.8  # Advanced PostgreSQL features (JSONB, HStore)

# API
djangorestframework==3.14.0  # REST API framework
djangorestframework-simplejwt==5.3.1  # JWT authentication
drf-spectacular==0.27.0  # Auto-generate OpenAPI/Swagger docs
django-filter==23.5  # Filtering querysets in API
django-cors-headers==4.3.1  # Handle CORS for frontend
drf-nested-routers==0.93.5  # Nested API routes (e.g., /orgs/123/teams/)

# Authentication
django-allauth==0.57.0  # Social auth & email verification

# Models & Utilities
django-model-utils==4.3.1  # Model mixins (TimeStampedModel, StatusModel)
django-lifecycle==1.1.1  # Model lifecycle hooks
django-fsm==2.8.1  # Finite state machines for models

# Caching
django-redis==5.4.0  # Redis cache backend
redis==5.0.1  # Redis client

# Async Tasks
celery==5.3.4  # Distributed task queue
django-celery-beat==2.5.0  # Periodic task scheduler
django-celery-results==2.5.1  # Store task results in DB
flower==2.0.1  # Celery monitoring UI

# Storage
django-storages==1.14.2  # Cloud storage backends (S3, GCS)
boto3==1.34.8  # AWS SDK for S3

# Validation & Security
django-ratelimit==4.1.0  # Rate limiting for views
django-defender==0.9.7  # Brute-force login protection

# Utilities
python-dateutil==2.8.2  # Date/time parsing
pytz==2023.3  # Timezone support
python-slugify==8.0.1  # Generate URL-safe slugs
```

### `requirements/development.txt`

Development-only tools for debugging, testing, and code quality.

```txt
-r base.txt  # Include all base requirements

# Development tools
django-debug-toolbar==4.2.0  # Debug panel showing SQL queries, cache hits, etc.
django-extensions==3.2.3  # Extra management commands (shell_plus, runserver_plus)
ipython==8.19.0  # Enhanced Python shell
django-silk==5.0.4  # Request profiling and inspection

# Testing
pytest==7.4.3  # Testing framework
pytest-django==4.7.0  # Django integration for pytest
pytest-cov==4.1.0  # Code coverage reports
pytest-xdist==3.5.0  # Run tests in parallel
factory-boy==3.3.0  # Create test fixtures easily
faker==21.0.0  # Generate fake data for tests
freezegun==1.4.0  # Mock datetime in tests

# Code Quality
black==23.12.1  # Code formatter
flake8==7.0.0  # Linter for style issues
isort==5.13.2  # Sort imports automatically
mypy==1.7.1  # Static type checker
pylint==3.0.3  # Advanced linter
```

### `requirements/production.txt`

Production-specific packages for serving, monitoring, and security.

```txt
-r base.txt  # Include all base requirements

# Production server
gunicorn==21.2.0  # WSGI HTTP server for Django
uvicorn==0.25.0  # ASGI server for async support

# Monitoring
sentry-sdk==1.39.2  # Error tracking and performance monitoring
django-prometheus==2.3.1  # Expose metrics for Prometheus

# Security
django-csp==3.8  # Content Security Policy headers
django-permissions-policy==4.19.0  # Permissions-Policy headers
```

### `requirements/test.txt`

Minimal testing dependencies for CI/CD pipelines.

```txt
-r base.txt  # Include all base requirements

pytest==7.4.3  # Testing framework
pytest-django==4.7.0  # Django integration
pytest-cov==4.1.0  # Coverage reports
factory-boy==3.3.0  # Test fixtures
faker==21.0.0  # Fake data generation
freezegun==1.4.0  # Mock datetime
```

---

## Configuration Files

<Warning>
Never commit your `.env` file to version control. Always use `.env.example` as a template and keep secrets secure.
</Warning>

### `.env.example`

Template for environment variables. Copy to `.env` and fill in your values.

```bash
# Environment
DJANGO_SETTINGS_MODULE=config.settings.development  # Which settings file to use
DEBUG=True  # Enable debug mode (never True in production)
SECRET_KEY=your-secret-key-here-change-in-production  # Django secret key for cryptographic signing

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/saas_platform  # PostgreSQL connection string

# Redis
REDIS_URL=redis://localhost:6379/0  # Redis for caching
CELERY_BROKER_URL=redis://localhost:6379/1  # Redis for Celery message broker

# Email
EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend  # Print emails to console (dev)
EMAIL_HOST=smtp.sendgrid.net  # SMTP server
EMAIL_PORT=587  # SMTP port
EMAIL_USE_TLS=True  # Use TLS encryption
EMAIL_HOST_USER=  # SMTP username
EMAIL_HOST_PASSWORD=  # SMTP password
DEFAULT_FROM_EMAIL=noreply@platform.com  # Default sender email

# AWS (for production)
AWS_ACCESS_KEY_ID=  # AWS access key for S3
AWS_SECRET_ACCESS_KEY=  # AWS secret key
AWS_STORAGE_BUCKET_NAME=  # S3 bucket name
AWS_S3_REGION_NAME=us-east-1  # AWS region

# Sentry (for production)
SENTRY_DSN=  # Sentry error tracking URL

# JWT Settings
JWT_ACCESS_TOKEN_LIFETIME=15  # Access token lifetime in minutes
JWT_REFRESH_TOKEN_LIFETIME=43200  # Refresh token lifetime in minutes (30 days)

# CORS
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000  # Allowed frontend origins

# Domain
DOMAIN=localhost:8000  # Your application domain
```

### `config/settings/base.py`

Base settings shared across all environments. Contains core Django configuration.

```python
"""
Base settings for SaaS Platform project.
"""
import os
from pathlib import Path
import environ

# Build paths - root directory of the project
BASE_DIR = Path(__file__).resolve().parent.parent.parent

# Environment variables - load from .env file
env = environ.Env(
    DEBUG=(bool, False)  # Default DEBUG to False for safety
)
environ.Env.read_env(os.path.join(BASE_DIR, '.env'))

<Warning>
**SECURITY WARNING**: Keep the secret key secure! Generate a strong random key for production and never share it.
</Warning>

SECRET_KEY = env('SECRET_KEY')  # Used for cryptographic signing (sessions, tokens, etc.)

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = env('DEBUG')  # Shows detailed error pages when True

ALLOWED_HOSTS = env.list('ALLOWED_HOSTS', default=['localhost', '127.0.0.1'])  # Domains allowed to serve the app

# Application definition
DJANGO_APPS = [
    'django.contrib.admin',  # Admin interface
    'django.contrib.auth',  # Authentication framework
    'django.contrib.contenttypes',  # Content type system
    'django.contrib.sessions',  # Session framework
    'django.contrib.messages',  # Messaging framework
    'django.contrib.staticfiles',  # Static file management
    'django.contrib.sites',  # Multi-site support
]

THIRD_PARTY_APPS = [
    # REST Framework
    'rest_framework',  # REST API framework
    'rest_framework_simplejwt',  # JWT authentication
    'drf_spectacular',  # API documentation
    'django_filters',  # Filtering support
    'corsheaders',  # CORS headers
    
    # Authentication
    'allauth',  # Authentication system
    'allauth.account',  # Account management
    'allauth.socialaccount',  # Social authentication
    
    # Utilities
    'django_celery_beat',  # Periodic tasks
    'django_celery_results',  # Task result storage
    
    # Model utilities
    'django_fsm',  # Finite state machines
]

LOCAL_APPS = [
    'apps.core',  # Core utilities and base models
    'apps.authentication',  # User authentication
    'apps.organizations',  # Organization/tenant management
    'apps.teams',  # Team management
    'apps.invitations',  # User invitations
    'apps.rbac',  # Role-based access control
    'apps.billing',  # Billing and subscriptions
    'apps.products',  # Product management
    'apps.notifications',  # Notification system
    'apps.audit',  # Audit logging
]

INSTALLED_APPS = DJANGO_APPS + THIRD_PARTY_APPS + LOCAL_APPS  # Combine all apps

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',  # Security enhancements
    'corsheaders.middleware.CorsMiddleware',  # Handle CORS headers
    'django.contrib.sessions.middleware.SessionMiddleware',  # Session management
    'django.middleware.common.CommonMiddleware',  # Common utilities
    'django.middleware.csrf.CsrfViewMiddleware',  # CSRF protection
    'django.contrib.auth.middleware.AuthenticationMiddleware',  # User authentication
    'django.contrib.messages.middleware.MessageMiddleware',  # Flash messages
    'django.middleware.clickjacking.XFrameOptionsMiddleware',  # Clickjacking protection
    
    # Custom middleware
    'apps.core.middleware.TenantContextMiddleware',  # Set tenant context for RLS
    'apps.audit.middleware.AuditMiddleware',  # Log all requests for audit
]

ROOT_URLCONF = 'config.urls'  # Main URL configuration

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',  # Template engine
        'DIRS': [BASE_DIR / 'templates'],  # Custom template directories
        'APP_DIRS': True,  # Look for templates in app directories
        'OPTIONS': {
            'context_processors': [  # Variables available in all templates
                'django.template.context_processors.debug',  # Debug info
                'django.template.context_processors.request',  # Request object
                'django.contrib.auth.context_processors.auth',  # User object
                'django.contrib.messages.context_processors.messages',  # Messages
            ],
        },
    },
]

WSGI_APPLICATION = 'config.wsgi.application'  # WSGI entry point

# Database - PostgreSQL connection from environment variable
DATABASES = {
    'default': env.db('DATABASE_URL', default='postgresql://localhost/saas_platform')
}

<Note>
**Custom User Model**: Set this before running your first migration. Changing it later is extremely difficult.
</Note>

# Custom User Model
AUTH_USER_MODEL = 'authentication.User'  # Use custom User model instead of Django's default

# Password validation - enforce strong passwords
AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',  # Prevent passwords similar to user info
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',  # Minimum 10 characters
        'OPTIONS': {
            'min_length': 10,
        }
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',  # Reject common passwords
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',  # Prevent all-numeric passwords
    },
]

# Internationalization
LANGUAGE_CODE = 'en-us'  # Default language
TIME_ZONE = 'UTC'  # Store all times in UTC
USE_I18N = True  # Enable internationalization
USE_TZ = True  # Use timezone-aware datetimes

# Static files (CSS, JavaScript, Images)
STATIC_URL = '/static/'  # URL prefix for static files
STATIC_ROOT = BASE_DIR / 'staticfiles'  # Where collectstatic puts files
STATICFILES_DIRS = [BASE_DIR / 'static']  # Additional static file locations

# Media files (user uploads)
MEDIA_URL = '/media/'  # URL prefix for media files
MEDIA_ROOT = BASE_DIR / 'media'  # Where uploaded files are stored

# Default primary key field type
DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'  # Use BigInt for primary keys

# Sites framework
SITE_ID = 1  # Required for django.contrib.sites

# REST Framework - API configuration
REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': (  # How users authenticate
        'rest_framework_simplejwt.authentication.JWTAuthentication',  # JWT tokens
        'rest_framework.authentication.SessionAuthentication',  # Session cookies
    ),
    'DEFAULT_PERMISSION_CLASSES': [  # Default permission for all views
        'rest_framework.permissions.IsAuthenticated',  # Require authentication
    ],
    'DEFAULT_FILTER_BACKENDS': [  # Enable filtering, search, and ordering
        'django_filters.rest_framework.DjangoFilterBackend',  # Field filtering
        'rest_framework.filters.SearchFilter',  # Text search
        'rest_framework.filters.OrderingFilter',  # Sort results
    ],
    'DEFAULT_PAGINATION_CLASS': 'apps.core.pagination.CustomPagination',  # Paginate results
    'PAGE_SIZE': 20,  # Default items per page
    'DEFAULT_SCHEMA_CLASS': 'drf_spectacular.openapi.AutoSchema',  # OpenAPI schema generation
    'EXCEPTION_HANDLER': 'apps.core.exceptions.custom_exception_handler',  # Custom error handling
}

<Info>
**JWT Configuration**: Short-lived access tokens (15 min) with refresh token rotation provide security while maintaining good UX.
</Info>

# JWT Settings
from datetime import timedelta

SIMPLE_JWT = {
    'ACCESS_TOKEN_LIFETIME': timedelta(minutes=env.int('JWT_ACCESS_TOKEN_LIFETIME', 15)),  # Short-lived access tokens
    'REFRESH_TOKEN_LIFETIME': timedelta(minutes=env.int('JWT_REFRESH_TOKEN_LIFETIME', 43200)),  # Long-lived refresh tokens (30 days)
    'ROTATE_REFRESH_TOKENS': True,  # Issue new refresh token on each use
    'BLACKLIST_AFTER_ROTATION': True,  # Invalidate old refresh token
    'UPDATE_LAST_LOGIN': True,  # Update user's last_login field
    'ALGORITHM': 'HS256',  # Signing algorithm
    'SIGNING_KEY': SECRET_KEY,  # Key used to sign tokens
    'AUTH_HEADER_TYPES': ('Bearer',),  # Authorization header format: "Bearer <token>"
    'USER_ID_FIELD': 'id',  # User model field for user ID
    'USER_ID_CLAIM': 'user_id',  # JWT claim name for user ID
    'AUTH_TOKEN_CLASSES': ('rest_framework_simplejwt.tokens.AccessToken',),  # Token classes
    'TOKEN_TYPE_CLAIM': 'token_type',  # JWT claim for token type
}

# DRF Spectacular (API Documentation) - OpenAPI/Swagger configuration
SPECTACULAR_SETTINGS = {
    'TITLE': 'SaaS Platform API',  # API title
    'DESCRIPTION': 'Multi-tenant SaaS platform API documentation',  # API description
    'VERSION': '1.0.0',  # API version
    'SERVE_INCLUDE_SCHEMA': False,  # Don't include schema in served docs
    'SCHEMA_PATH_PREFIX': '/api/v1',  # API path prefix
    'COMPONENT_SPLIT_REQUEST': True,  # Split request/response schemas
}

# CORS - Allow frontend to make requests
CORS_ALLOWED_ORIGINS = env.list('CORS_ALLOWED_ORIGINS', default=[])  # Allowed origins
CORS_ALLOW_CREDENTIALS = True  # Allow cookies in CORS requests

<Note>
**Celery** handles asynchronous tasks like sending emails, processing webhooks, and running scheduled jobs.
</Note>

# Celery Configuration - Async task queue
CELERY_BROKER_URL = env('CELERY_BROKER_URL', default='redis://localhost:6379/1')  # Message broker
CELERY_RESULT_BACKEND = 'django-db'  # Store results in database
CELERY_ACCEPT_CONTENT = ['json']  # Accept only JSON messages
CELERY_TASK_SERIALIZER = 'json'  # Serialize tasks as JSON
CELERY_RESULT_SERIALIZER = 'json'  # Serialize results as JSON
CELERY_TIMEZONE = TIME_ZONE  # Use same timezone as Django
CELERY_TASK_TRACK_STARTED = True  # Track when tasks start
CELERY_TASK_TIME_LIMIT = 30 * 60  # Kill tasks after 30 minutes

# Celery Beat - Periodic task scheduler
CELERY_BEAT_SCHEDULER = 'django_celery_beat.schedulers:DatabaseScheduler'  # Store schedule in DB

# Cache - Redis for caching
CACHES = {
    'default': {  # General purpose cache
        'BACKEND': 'django_redis.cache.RedisCache',
        'LOCATION': env('REDIS_URL', default='redis://localhost:6379/0'),
        'OPTIONS': {
            'CLIENT_CLASS': 'django_redis.client.DefaultClient',
        }
    },
    'permissions': {  # Cache for permission checks
        'BACKEND': 'django_redis.cache.RedisCache',
        'LOCATION': env('REDIS_URL', default='redis://localhost:6379/0'),
        'TIMEOUT': 300,  # 5 minutes
        'OPTIONS': {
            'CLIENT_CLASS': 'django_redis.client.DefaultClient',
        }
    },
    'sessions': {  # Cache for user sessions
        'BACKEND': 'django_redis.cache.RedisCache',
        'LOCATION': env('REDIS_URL', default='redis://localhost:6379/0'),
        'TIMEOUT': 86400,  # 24 hours
        'OPTIONS': {
            'CLIENT_CLASS': 'django_redis.client.DefaultClient',
        }
    }
}

# Session - Store sessions in Redis cache
SESSION_ENGINE = 'django.contrib.sessions.backends.cache'  # Use cache for sessions
SESSION_CACHE_ALIAS = 'sessions'  # Use 'sessions' cache

# Email Configuration
EMAIL_BACKEND = env('EMAIL_BACKEND', default='django.core.mail.backends.console.EmailBackend')  # Email backend (console for dev)
EMAIL_HOST = env('EMAIL_HOST', default='localhost')  # SMTP server
EMAIL_PORT = env.int('EMAIL_PORT', default=25)  # SMTP port
EMAIL_USE_TLS = env.bool('EMAIL_USE_TLS', default=False)  # Use TLS encryption
EMAIL_HOST_USER = env('EMAIL_HOST_USER', default='')  # SMTP username
EMAIL_HOST_PASSWORD = env('EMAIL_HOST_PASSWORD', default='')  # SMTP password
DEFAULT_FROM_EMAIL = env('DEFAULT_FROM_EMAIL', default='noreply@platform.com')  # Default sender

# Logging - Configure application logging
LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'formatters': {
        'verbose': {  # Detailed log format
            'format': '{levelname} {asctime} {module} {process:d} {thread:d} {message}',
            'style': '{',
        },
        'simple': {  # Simple log format
            'format': '{levelname} {message}',
            'style': '{',
        },
    },
    'handlers': {
        'console': {  # Log to console/stdout
            'class': 'logging.StreamHandler',
            'formatter': 'verbose',
        },
        'file': {  # Log to rotating file
            'class': 'logging.handlers.RotatingFileHandler',
            'filename': BASE_DIR / 'logs' / 'django.log',
            'maxBytes': 1024 * 1024 * 15,  # 15MB per file
            'backupCount': 10,  # Keep 10 backup files
            'formatter': 'verbose',
        },
    },
    'root': {  # Root logger configuration
        'handlers': ['console', 'file'],
        'level': 'INFO',
    },
    'loggers': {
        'django': {  # Django framework logs
            'handlers': ['console', 'file'],
            'level': 'INFO',
            'propagate': False,
        },
        'apps': {  # Application logs
            'handlers': ['console', 'file'],
            'level': 'DEBUG',
            'propagate': False,
        },
    },
}

# Custom settings - Application-specific configuration
DOMAIN = env('DOMAIN', default='localhost:8000')  # Application domain
INVITATION_EXPIRY_DAYS = 7  # Invitations expire after 7 days
MAGIC_LINK_EXPIRY_MINUTES = 15  # Magic links expire after 15 minutes
```

### `config/settings/development.py`

Development-specific settings with debugging tools and relaxed security.

```python
from .base import *

DEBUG = True  # Enable debug mode

ALLOWED_HOSTS = ['localhost', '127.0.0.1', '0.0.0.0']  # Allow local access

# Debug toolbar - adds debug panel to pages
INSTALLED_APPS += [
    'debug_toolbar',  # Debug toolbar with SQL queries, cache hits, etc.
    'django_extensions',  # Extra management commands
]

MIDDLEWARE = ['debug_toolbar.middleware.DebugToolbarMiddleware'] + MIDDLEWARE  # Add debug toolbar middleware

INTERNAL_IPS = ['127.0.0.1']  # IPs that can see debug toolbar

# Email backend for development - print emails to console
EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'

# Disable some security features for development (never do this in production!)
SECURE_SSL_REDIRECT = False  # Don't force HTTPS
SESSION_COOKIE_SECURE = False  # Allow cookies over HTTP
CSRF_COOKIE_SECURE = False  # Allow CSRF cookies over HTTP
```

<Warning>
**Production Settings**: These security settings are critical. Never run production with DEBUG=True or without HTTPS.
</Warning>

### `config/settings/production.py`

Production settings with maximum security and monitoring enabled.

```python
from .base import *

DEBUG = False  # Never enable debug in production

ALLOWED_HOSTS = env.list('ALLOWED_HOSTS')  # Only allow specific domains

# Security - enforce HTTPS and secure cookies
SECURE_SSL_REDIRECT = True  # Redirect all HTTP to HTTPS
SECURE_PROXY_SSL_HEADER = ('HTTP_X_FORWARDED_PROTO', 'https')  # Trust proxy headers
SESSION_COOKIE_SECURE = True  # Only send session cookie over HTTPS
CSRF_COOKIE_SECURE = True  # Only send CSRF cookie over HTTPS
SECURE_HSTS_SECONDS = 31536000  # Tell browsers to use HTTPS for 1 year
SECURE_HSTS_INCLUDE_SUBDOMAINS = True  # Apply HSTS to subdomains
SECURE_HSTS_PRELOAD = True  # Allow inclusion in browser HSTS preload list
SECURE_CONTENT_TYPE_NOSNIFF = True  # Prevent MIME type sniffing
SECURE_BROWSER_XSS_FILTER = True  # Enable XSS filter
X_FRAME_OPTIONS = 'DENY'  # Prevent clickjacking

# Session - secure session cookies
SESSION_COOKIE_HTTPONLY = True  # Prevent JavaScript access to session cookie
SESSION_COOKIE_SAMESITE = 'Strict'  # Prevent CSRF via cookies
SESSION_COOKIE_AGE = 86400  # 24 hours

# CSRF - secure CSRF cookies
CSRF_COOKIE_HTTPONLY = True  # Prevent JavaScript access to CSRF cookie
CSRF_COOKIE_SAMESITE = 'Strict'  # Prevent CSRF attacks

# Sentry - error tracking and performance monitoring
import sentry_sdk
from sentry_sdk.integrations.django import DjangoIntegration
from sentry_sdk.integrations.celery import CeleryIntegration

sentry_sdk.init(
    dsn=env('SENTRY_DSN', default=''),  # Sentry project URL
    integrations=[
        DjangoIntegration(),  # Django integration
        CeleryIntegration(),  # Celery integration
    ],
    traces_sample_rate=0.1,  # Sample 10% of transactions for performance monitoring
    send_default_pii=False,  # Don't send personally identifiable information
    environment='production',  # Environment name
)

# Storage (AWS S3) - use S3 for static and media files
if env('AWS_ACCESS_KEY_ID', default=None):
    AWS_ACCESS_KEY_ID = env('AWS_ACCESS_KEY_ID')
    AWS_SECRET_ACCESS_KEY = env('AWS_SECRET_ACCESS_KEY')
    AWS_STORAGE_BUCKET_NAME = env('AWS_STORAGE_BUCKET_NAME')
    AWS_S3_REGION_NAME = env('AWS_S3_REGION_NAME', default='us-east-1')
    AWS_S3_CUSTOM_DOMAIN = f'{AWS_STORAGE_BUCKET_NAME}.s3.amazonaws.com'
    AWS_DEFAULT_ACL = 'private'  # Files are private by default
    AWS_S3_OBJECT_PARAMETERS = {
        'CacheControl': 'max-age=86400',  # Cache for 24 hours
    }
    
    # Static files - serve from S3
    STATICFILES_STORAGE = 'storages.backends.s3boto3.S3Boto3Storage'
    STATIC_URL = f'https://{AWS_S3_CUSTOM_DOMAIN}/static/'
    
    # Media files - serve from S3
    DEFAULT_FILE_STORAGE = 'storages.backends.s3boto3.S3Boto3Storage'
    MEDIA_URL = f'https://{AWS_S3_CUSTOM_DOMAIN}/media/'

# Logging to file in production
LOGGING['handlers']['file']['filename'] = '/var/log/django/saas_platform.log'  # Production log path
```

### `config/settings/test.py`

Test settings optimized for speed with in-memory database and synchronous tasks.

```python
from .base import *

DEBUG = False  # Disable debug mode in tests

# Use in-memory database for tests - much faster than PostgreSQL
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',  # SQLite in memory
        'NAME': ':memory:',  # Store in RAM
    }
}

# Disable migrations for faster tests - create tables directly from models
class DisableMigrations:
    def __contains__(self, item):
        return True
    
    def __getitem__(self, item):
        return None

MIGRATION_MODULES = DisableMigrations()  # Skip migrations

# Fast password hasher for tests - MD5 is insecure but fast for testing
PASSWORD_HASHERS = [
    'django.contrib.auth.hashers.MD5PasswordHasher',
]

# Celery - run tasks synchronously in tests (no separate worker needed)
CELERY_TASK_ALWAYS_EAGER = True  # Execute tasks immediately
CELERY_TASK_EAGER_PROPAGATES = True  # Propagate exceptions

# Email - store emails in memory for testing
EMAIL_BACKEND = 'django.core.mail.backends.locmem.EmailBackend'
```

---

## Core Configuration Files

### `config/__init__.py`

Initialize Celery when Django starts.

```python
# This will make sure the app is always imported when
# Django starts so that shared_task will use this app.
from .celery import app as celery_app  # Import Celery app

__all__ = ('celery_app',)  # Export celery_app
```

### `config/celery.py`

Celery configuration for async task processing and scheduled jobs.

```python
import os
from celery import Celery
from celery.schedules import crontab

# Set default Django settings module
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings.development')

app = Celery('saas_platform')  # Create Celery app

# Using a string here means the worker doesn't have to serialize
# the configuration object to child processes.
app.config_from_object('django.conf:settings', namespace='CELERY')  # Load config from Django settings

# Load task modules from all registered Django apps.
app.autodiscover_tasks()  # Auto-discover tasks.py in each app

# Celery Beat schedule - periodic tasks
app.conf.beat_schedule = {
    'cleanup-expired-invitations': {  # Clean up old invitations
        'task': 'apps.invitations.tasks.cleanup_expired_invitations',
        'schedule': crontab(hour=2, minute=0),  # Run at 2 AM daily
    },
    'cleanup-expired-sessions': {  # Clean up old sessions
        'task': 'apps.authentication.tasks.cleanup_expired_sessions',
        'schedule': crontab(hour=3, minute=0),  # Run at 3 AM daily
    },
}

@app.task(bind=True, ignore_result=True)
def debug_task(self):
    """Debug task to test Celery is working"""
    print(f'Request: {self.request!r}')
```

### `config/urls.py`

Main URL configuration routing requests to different apps.

```python
from django.contrib import admin
from django.urls import path, include
from django.conf import settings
from django.conf.urls.static import static
from drf_spectacular.views import (
    SpectacularAPIView,
    SpectacularRedocView,
    SpectacularSwaggerView,
)

urlpatterns = [
    # Admin - Django admin interface
    path('admin/', admin.site.urls),
    
    # API Documentation - OpenAPI/Swagger docs
    path('api/schema/', SpectacularAPIView.as_view(), name='schema'),  # OpenAPI schema
    path('api/docs/', SpectacularSwaggerView.as_view(url_name='schema'), name='swagger-ui'),  # Swagger UI
    path('api/redoc/', SpectacularRedocView.as_view(url_name='schema'), name='redoc'),  # ReDoc UI
    
    # API v1 - main API endpoints
    path('api/v1/auth/', include('apps.authentication.urls')),  # Authentication endpoints
    path('api/v1/', include('apps.organizations.urls')),  # Organization endpoints
    path('api/v1/', include('apps.teams.urls')),  # Team endpoints
    path('api/v1/', include('apps.invitations.urls')),  # Invitation endpoints
    path('api/v1/', include('apps.rbac.urls')),  # RBAC endpoints
    path('api/v1/', include('apps.notifications.urls')),  # Notification endpoints
    path('api/v1/', include('apps.audit.urls')),  # Audit log endpoints
    
    # Health check - for monitoring/load balancers
    path('health/', include('health_check.urls')),
]

# Development-only URLs
if settings.DEBUG:
    import debug_toolbar
    urlpatterns = [
        path('__debug__/', include(debug_toolbar.urls)),  # Debug toolbar
    ] + urlpatterns
    
    # Serve media and static files in development
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
    urlpatterns += static(settings.STATIC_URL, document_root=settings.STATIC_ROOT)
```

### `config/wsgi.py`

WSGI entry point for production servers (Gunicorn, uWSGI).

```python
import os
from django.core.wsgi import get_wsgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings.production')  # Default to production settings

application = get_wsgi_application()  # Create WSGI application
```

### `config/asgi.py`

ASGI entry point for async servers (Uvicorn, Daphne) and WebSockets.

```python
import os
from django.core.asgi import get_asgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings.production')  # Default to production settings

application = get_asgi_application()  # Create ASGI application
```

---

## Additional Configuration Files

### `.gitignore`

```
# Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
env/
venv/
ENV/
*.egg-info/
dist/
build/

# Django
*.log
db.sqlite3
db.sqlite3-journal
/media
/staticfiles
/static_cdn

# Environment
.env
.env.local

# IDE
.vscode/
.idea/
*.swp
*.swo
*~

# OS
.DS_Store
Thumbs.db

# Testing
.coverage
htmlcov/
.pytest_cache/
.tox/

# Celery
celerybeat-schedule
celerybeat.pid

# Logs
logs/
*.log
```

### `pytest.ini`

```ini
[pytest]
DJANGO_SETTINGS_MODULE = config.settings.test
python_files = tests.py test_*.py *_tests.py
python_classes = Test*
python_functions = test_*
addopts = 
    --reuse-db
    --nomigrations
    --cov=apps
    --cov-report=html
    --cov-report=term-missing
    --verbose
testpaths = tests
```

### `setup.cfg`

```ini
[flake8]
max-line-length = 100
exclude = 
    .git,
    __pycache__,
    */migrations/*,
    */static/*,
    */media/*,
    venv,
    env
ignore = E203, E266, W503

[isort]
profile = black
line_length = 100
skip = migrations, venv, env

[mypy]
python_version = 3.11
warn_return_any = True
warn_unused_configs = True
ignore_missing_imports = True
plugins = mypy_django_plugin.main

[mypy.plugins.django-stubs]
django_settings_module = config.settings.development
```

### `manage.py`

```python
#!/usr/bin/env python
"""Django's command-line utility for administrative tasks."""
import os
import sys


def main():
    """Run administrative tasks."""
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings.development')
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            "Couldn't import Django. Are you sure it's installed and "
            "available on your PYTHONPATH environment variable? Did you "
            "forget to activate a virtual environment?"
        ) from exc
    execute_from_command_line(sys.argv)


if __name__ == '__main__':
    main()
```

---

## Next Steps

<Info>
**Phase 1 Complete!** You now have a solid foundation with environment-based configuration, security settings, and all required packages.
</Info>

This provides:

- ✅ Complete project structure
- ✅ Environment-based settings (dev/prod/test)
- ✅ All required packages configured
- ✅ Database, cache, and Celery setup
- ✅ Security settings
- ✅ API documentation setup
- ✅ Logging configuration

**Ready for Phase 2?** Reply with "Continue to Phase 2" and I'll implement:

- Core app with base models and utilities
- Custom User model
- Authentication system
- Middleware for tenant context
- Base permissions and exceptions